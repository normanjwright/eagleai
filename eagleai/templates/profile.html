{% extends 'base.html' %} 
{% block title %}Profile{% endblock %} 
{% block content %} 



    <div class="container-fluid" >

            <div class="container">
                <div class="box">
                    <h3> {{studentname}} </h3>
                    <h5> {{student.grad_year}} </h5>
                    <h5> {{studentsch}} </h5>
                    
                </div>
                <div class="box">
                    <h3>Programs</h3>
                    <ul>
                        <h5> Majors: </h5>
                        {% for major in studentMaj %}
                            <li>{{ major }}</li>
                        {% endfor %}
                        
                        
                        <h5 style="margin-top: 20px;">Minors: </h5>
                        {% for minor in studentMin %}
                            <li>{{ minor }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="box">
                    <h3>What if?</h3>
            
                        <select id="courseDept" name="courseDept" class="form-select mx-2" style="max-height: 70vh; overflow:scroll;max-width:125px;">
                            <option selected>Major</option>
                            {% for dept in departments %}
                                <option>{{ dept }}</option>
                            {% endfor %}
                        </select>
                        
                        <select id="courseDept" name="courseDept" class="form-select mx-2" style="max-height: 70vh; overflow:scroll;max-width:125px;">
                            <option selected>Minor</option>
                            {% for dept in departments %}
                                <option>{{ dept }}</option>
                            {% endfor %}
                        </select>

                           
                          <a href="url">Restore Declared Programs</a>
                          <a href="url">Restore Classes Taken</a> 
                    </div>
                    
                </div>
            </div>

            <div class="container mt-5">
                <h2>Add Courses</h2>
                <form id="dynamicForm" method="POST" action="\update_courses">
                    <select name="Semester" id="semester">
                        <option value="Freshman Fall">Freshman Fall</option>
                        <option value="Freshman Spring">Freshman Spring</option>
                        <option value="Freshman Summer">Freshman Summer</option>
                        <option value="Sophomore Fall">Sophomore Fall</option>
                        <option value="Sophomore Spring">Sophomore Spring</option>
                        <option value="Sophomore Summer">Sophomore Summer</option>
                        <option value="Junior Fall">Junior Fall</option>
                        <option value="Junior Spring">Junior Spring</option>
                        <option value="Junior Summer">Junior Summer</option>
                        <option value="Senior Fall">Senior Fall</option>
                        <option value="Senior Spring">Senior Spring</option>
                      </select>

                      <div id="coursesContainer">
                        <div class="form-group" id="courseGroup1">
                            <label for="item1">Course 1:</label>
                            <select id="courseDeptadd1" name="courseDeptadd[]" onchange="updateCourses(this)" class="form-select mx-2" style="max-height: 70vh; overflow:scroll;max-width:125px;">
                                <option selected>Department</option>
                                {% for dept in departments %}
                                    <option>{{ dept }}</option>
                                {% endfor %}
                            </select>
                            <select id="courseList1" name="courseList[]" class="form-select mx-2" style="max-height: 70vh; overflow:scroll;max-width:125px;">
                                <option selected disabled>Course</option>
                            </select>
                        </div>
                    </div>
                
                    <button type="button" class="btn btn-primary" onclick="addItem()">Add More</button>
                    <button type="submit" class="btn btn-success">Update</button>
                </form>
                
                <script>
                    let itemCount = 1;
                
                    function addItem() {
                        itemCount++;
                        const container = document.getElementById('coursesContainer');
                        const newItem = document.createElement('div');
                        newItem.className = 'form-group';
                        newItem.id = `courseGroup${itemCount}`;
                        newItem.innerHTML = `
                            <label for="item${itemCount}">Course ${itemCount}:</label>
                            <select id="courseDeptadd${itemCount}" name="courseDeptadd[]" onchange="updateCourses(this)" class="form-select mx-2" style="max-height: 70vh; overflow:scroll;max-width:125px;">
                                <option selected>Department</option>
                                {% for dept in departments %}
                                    <option>{{ dept }}</option>
                                {% endfor %}
                            </select>
                            <select id="courseList${itemCount}" name="courseList[]" class="form-select mx-2" style="max-height: 70vh; overflow:scroll;max-width:125px;">
                                <option selected disabled>Course</option>
                            </select>
                        `;
                        container.appendChild(newItem);
                    }
                
                    function updateCourses(selectElement) {
                        const department = selectElement.value;
                        const courseList = selectElement.nextElementSibling;
                        courseList.innerHTML = '<option selected>Loading...</option>';
                
                        fetch(`/get_courses/${department}`)
                            .then(response => response.json())
                            .then(data => {
                                courseList.innerHTML = '<option selected disabled>Course</option>';
                                data.forEach(course => {
                                    const option = document.createElement('option');
                                    option.value = course;
                                    option.textContent = course;
                                    courseList.appendChild(option);
                                });
                            });
                    }
                </script>

            </div>  

            <div class="bottom-container">
                <div class="bottom-box">
                    <h4 class="font-weight-bold">Freshman Year</h3>
                    <h5 class="font-weight-bold">Fall</h5>
                    {% for course in student.academic_record["Freshman Fall"] %}
                    <p>{{ course }} 
                        <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button></p>
                    {% endfor %}
                    <h5 class="font-weight-bold">Spring</h5>
                        {% for course in student.academic_record["Freshman Spring"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button></p>
                        {% endfor %}
                    <h5 class="font-weight-bold"> Summer</h5>
                        {% for course in student.academic_record["Freshman Summer"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                </div>
            
                <!-- Button dropdowns -->

                
                <div class="bottom-box">
                    <h4 class="font-weight-bold">Sophomore Year</h3>
                    <h5 class="font-weight-bold">Fall</h5>
                    {% for course in student.academic_record["Sophomore Fall"] %}
                    <p>{{ course }}
                        <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                    </p>
                    {% endfor %}
                    <h5 class="font-weight-bold">Spring</h5>
                        {% for course in student.academic_record["Sophomore Spring"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                    <h5 class="font-weight-bold"> Summer</h5>
                        {% for course in student.academic_record["Sophomore Summer"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                </div>


                <div class="bottom-box">
                    <h4 class="font-weight-bold">Junior Year</h3>
                    <h5 class="font-weight-bold">Fall</h5>
                    {% for course in student.academic_record["Junior Fall"] %}
                    <p>{{ course }}
                        <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                    </p>
                    {% endfor %}
                    <h5 class="font-weight-bold">Spring</h5>
                        {% for course in student.academic_record["Junior Spring"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                    <h5 class="font-weight-bold"> Summer</h5>
                        {% for course in student.academic_record["Junior Summer"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                </div>
                <div class="bottom-box">
                    <h4 class="font-weight-bold">Senior Year</h3>
                    <h5 class="font-weight-bold">Fall</h5>
                    {% for course in student.academic_record["Senior Fall"] %}
                    <p>{{ course }}
                        <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                    </p>
                    {% endfor %}
                    <h5 class="font-weight-bold">Spring</h5>
                        {% for course in student.academic_record["Senior Spring"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                    <h5 class="font-weight-bold"> Summer</h5>
                        {% for course in student.academic_record["Senior Summer"] %}
                        <p>{{ course }}
                            <button type="button" class="btn-close btn-sm btn-red delete-course" 
                        data-course="{{ course }}" aria-label="Close">x</button>
                        </p>
                        {% endfor %}
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $(".delete-course").click(function() {
                        var course = $(this).data("course");
                        var button = $(this);
            
                        $.ajax({
                            type: "POST",
                            url: "/delete_course",
                            data: { course: course },
                            success: function(response) {
                                window.location.reload(); // Reload the page to see the updated list
                            },
                            error: function(error) {
                                console.error("Error deleting course:", error);
                            }
                        });
                    });
                });
            </script>
    </div>
{% endblock %}
